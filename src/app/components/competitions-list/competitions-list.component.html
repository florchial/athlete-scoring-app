<div>
  <div class="center-buttons">
    <button mat-raised-button style="margin-top: 10px; zoom: 150%" color="primary" [routerLink]="['/']">Atr√°s</button>
    <button mat-raised-button style="margin-top: 10px; margin-left: 8px; zoom: 150%" (click)="refresh()">Refrescar
    </button>
  </div>
<h1>COMPETENCIAS </h1>
</div>
<div class="center" *ngIf="!isError && !isLoading">
  <table mat-table [dataSource]="competitions">
    <ng-container matColumnDef="category">
      <th mat-header-cell *matHeaderCellDef style="width:30%; "> COMPETENCIA</th>
      <td mat-cell *matCellDef="let competition"> {{competition.category}} </td>
    </ng-container>
    <ng-container matColumnDef="level">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let competition"> {{competition.age_range}} </td>
    </ng-container>
    <ng-container matColumnDef="style">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let competition"> {{competition.style}} </td>
    </ng-container>
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef style="width: 15%;"></th>
      <td mat-cell *matCellDef="let competition" >
      <div *ngIf="competition.finished" style="text-align: center">
        Finalizada
      </div>
        <div *ngIf="!competition.started && !competition.finished" style="text-align: center">
          No iniciada
        </div>
        <div *ngIf="competition.started && !competition.finished" style="text-align: center">
          En curso
        </div>
      </td>
    </ng-container>
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef style="width: 25%;"> ACCIONES</th>
      <td mat-cell *matCellDef="let competition">
        <div class="button-row">
          <div *ngIf="this.roleService.headJudge() && !competition.started && !competition.finished">
            <button mat-raised-button (click)="start(competition)">
              Iniciar
            </button>
          </div>
          <button mat-raised-button *ngIf="!competition.finished && this.roleService.admin()"
                  (click)="addAthletes(competition)">Agregar Competidores
          </button>
          <button mat-raised-button *ngIf="!competition.finished && competition.started"
                  (click)="score(competition)">Competidores
          </button>
          <button mat-raised-button *ngIf="this.roleService.maintainer() && (competition.started || competition.finished)"
                  (click)="ranking(competition._id)">Ranking
          </button>
          <div *ngIf="this.roleService.headJudge() && competition.started && !competition.finished">
            <button mat-raised-button
                    (click)="finish(competition)"
                    color="warn">
              Finalizar
            </button>
          </div>
        </div>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
<div *ngIf="isLoading && !isError"
     style="display: flex; justify-content: center; align-items: center; margin: 2vw; background: white;">
  <mat-progress-spinner
    color="primary"
    mode="indeterminate">
  </mat-progress-spinner>
</div>
<div *ngIf="isError">
  <h2 style="display: flex; justify-content: center; align-items: center; margin: 2vw; background: white;color: red">
    Error al cargar competidores. Intente nuevamente</h2>
</div>
<router-outlet></router-outlet>
